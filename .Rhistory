stat_summary(fun="mean", geom="point", color="black", size=2) +
stat_summary(fun="mean", geom="line", color="black", size=1)
ggsave(paste("Graphs\\Clusters vs. Background\\", mod, ".pdf", sep = ""), plot = plot, width = 16, height = 6)
plot <- ggplot(df, aes(x = axisGroup, y = ModificationDifference)) +
scale_x_continuous(limits = c(-70, 150), breaks = seq(-60, 140, 20), labels = axisText) +
scale_y_continuous(limits = c(0,1), expand = c(0,0)) +
geom_boxplot(aes(group = Region)) + theme_minimal() + coord_cartesian(ylim= c(0,1), clip = "off") +
labs(x = "", y = "Difference in proportion of gene region modified") +
geom_vline(xintercept=0, color="grey", linewidth=1) + theme(plot.margin = unit(c(1,1,1,1), "lines")) +
annotation_custom(textGrob("% of gene length from TSS", gp=gpar(fontsize=12, col = "grey33")),xmin=-10,xmax=100,ymin=-.23,ymax=-.23) +
annotation_custom(textGrob("Gene region", gp=gpar(fontsize=14)),xmin=-10,xmax=100,ymin=-.3,ymax=-.3) +
theme(axis.text.x = element_text(size = 11, colour = "black", angle = 45, vjust = 1, hjust = 1), axis.text.y = element_text(size = 12,colour = "black"),
axis.title.y = element_text(size = 14, vjust = 2), strip.text = element_text(size = 16),) +
facet_wrap(~Comparison, labeller = labeller(Comparison = facetLabels)) +
stat_summary(fun="mean", geom="point", color="black", size=2) +
stat_summary(fun="mean", geom="line", color="black", size=1)
ggplot(df, aes(x = axisGroup, y = ModificationDifference)) +
scale_x_continuous(limits = c(-70, 150), breaks = seq(-60, 140, 20), labels = axisText) +
scale_y_continuous(limits = c(0,1), expand = c(0,0)) +
geom_boxplot(aes(group = Region)) + theme_minimal() + coord_cartesian(ylim= c(0,1), clip = "off") +
labs(x = "", y = "Difference in proportion of gene region modified") +
geom_vline(xintercept=0, color="grey", linewidth=1) + theme(plot.margin = unit(c(1,1,1,1), "lines")) +
annotation_custom(textGrob("% of gene length from TSS", gp=gpar(fontsize=12, col = "grey33")),xmin=-10,xmax=100,ymin=-.23,ymax=-.23) +
annotation_custom(textGrob("Gene region", gp=gpar(fontsize=14)),xmin=-10,xmax=100,ymin=-.3,ymax=-.3) +
theme(axis.text.x = element_text(size = 14, colour = "black", angle = 45, vjust = 1, hjust = 1), axis.text.y = element_text(size = 14,colour = "black"),
axis.title.y = element_text(size = 16, vjust = 2), plot.title = element_text(hjust = .5, size = 16),
legend.text = element_text(size = 12), legend.title = element_text(size = 14), axis.line = element_line(linewidth = .6)) +
facet_wrap(~Comparison, labeller = labeller(Comparison = facetLabels)) +
stat_summary(fun="mean", geom="point", color="black", size=2) +
stat_summary(fun="mean", geom="line", color="black", size=1)
plot <- ggplot(df, aes(x = axisGroup, y = ModificationDifference)) +
scale_x_continuous(limits = c(-70, 150), breaks = seq(-60, 140, 20), labels = axisText) +
scale_y_continuous(limits = c(0,1), expand = c(0,0)) +
geom_boxplot(aes(group = Region)) + theme_minimal() + coord_cartesian(ylim= c(0,1), clip = "off") +
labs(x = "", y = "Difference in proportion of gene region modified") +
geom_vline(xintercept=0, color="grey", linewidth=1) + theme(plot.margin = unit(c(1,1,1,1), "lines")) +
annotation_custom(textGrob("% of gene length from TSS", gp=gpar(fontsize=12, col = "grey33")),xmin=-10,xmax=100,ymin=-.23,ymax=-.23) +
annotation_custom(textGrob("Gene region", gp=gpar(fontsize=14)),xmin=-10,xmax=100,ymin=-.3,ymax=-.3) +
theme(axis.text.x = element_text(size = 14, colour = "black", angle = 45, vjust = 1, hjust = 1), axis.text.y = element_text(size = 14,colour = "black"),
axis.title.y = element_text(size = 16, vjust = 2), plot.title = element_text(hjust = .5, size = 16),
legend.text = element_text(size = 12), legend.title = element_text(size = 14), axis.line = element_line(linewidth = .6)) +
facet_wrap(~Comparison, labeller = labeller(Comparison = facetLabels)) +
stat_summary(fun="mean", geom="point", color="black", size=2) +
stat_summary(fun="mean", geom="line", color="black", size=1)
ggsave(paste("Graphs\\Clusters vs. Background\\", mod, ".pdf", sep = ""), plot = plot, width = 16, height = 6)
ggplot(df, aes(x = axisGroup, y = ModificationDifference)) +
scale_x_continuous(limits = c(-70, 150), breaks = seq(-60, 140, 20), labels = axisText) +
scale_y_continuous(limits = c(0,1), expand = c(0,0)) +
geom_boxplot(aes(group = Region)) + theme_minimal() + coord_cartesian(ylim= c(0,1), clip = "off") +
labs(x = "", y = "Difference in proportion of gene region modified") +
geom_vline(xintercept=0, color="grey", linewidth=1) + theme(plot.margin = unit(c(1,1,1,1), "lines")) +
annotation_custom(textGrob("% of gene length from TSS", gp=gpar(fontsize=12, col = "grey33")),xmin=-10,xmax=100,ymin=-.23,ymax=-.23) +
annotation_custom(textGrob("Gene region", gp=gpar(fontsize=14)),xmin=-10,xmax=100,ymin=-.3,ymax=-.3) +
theme(axis.text.x = element_text(size = 12, colour = "black", angle = 45, vjust = 1, hjust = 1), axis.text.y = element_text(size = 12,colour = "black"),
axis.title.y = element_text(size = 14, vjust = 2),
legend.text = element_text(size = 12), legend.title = element_text(size = 14), axis.line = element_line(linewidth = .6)) +
facet_wrap(~Comparison, labeller = labeller(Comparison = facetLabels)) +
stat_summary(fun="mean", geom="point", color="black", size=2) +
stat_summary(fun="mean", geom="line", color="black", size=1)
ggplot(df, aes(x = axisGroup, y = ModificationDifference)) +
scale_x_continuous(limits = c(-70, 150), breaks = seq(-60, 140, 20), labels = axisText) +
scale_y_continuous(limits = c(0,1), expand = c(0,0)) +
geom_boxplot(aes(group = Region)) + theme_minimal() + coord_cartesian(ylim= c(0,1), clip = "off") +
labs(x = "", y = "Difference in proportion of gene region modified") +
geom_vline(xintercept=0, color="grey", linewidth=1) + theme(plot.margin = unit(c(1,1,1,1), "lines")) +
annotation_custom(textGrob("% of gene length from TSS", gp=gpar(fontsize=12, col = "grey33")),xmin=-10,xmax=100,ymin=-.2,ymax=-.2) +
annotation_custom(textGrob("Gene region", gp=gpar(fontsize=14)),xmin=-10,xmax=100,ymin=-.25,ymax=-.25) +
theme(axis.text.x = element_text(size = 12, colour = "black", angle = 45, vjust = 1, hjust = 1), axis.text.y = element_text(size = 12,colour = "black"),
axis.title.y = element_text(size = 14, vjust = 2), strip.text = element_text(size = 16),
legend.text = element_text(size = 12), legend.title = element_text(size = 14), axis.line = element_line(linewidth = .6)) +
facet_wrap(~Comparison, labeller = labeller(Comparison = facetLabels)) +
stat_summary(fun="mean", geom="point", color="black", size=2) +
stat_summary(fun="mean", geom="line", color="black", size=1)
plot <- ggplot(df, aes(x = axisGroup, y = ModificationDifference)) +
scale_x_continuous(limits = c(-70, 150), breaks = seq(-60, 140, 20), labels = axisText) +
scale_y_continuous(limits = c(0,1), expand = c(0,0)) +
geom_boxplot(aes(group = Region)) + theme_minimal() + coord_cartesian(ylim= c(0,1), clip = "off") +
labs(x = "", y = "Difference in proportion of gene region modified") +
geom_vline(xintercept=0, color="grey", linewidth=1) + theme(plot.margin = unit(c(1,1,1,1), "lines")) +
annotation_custom(textGrob("% of gene length from TSS", gp=gpar(fontsize=12, col = "grey33")),xmin=-10,xmax=100,ymin=-.2,ymax=-.2) +
annotation_custom(textGrob("Gene region", gp=gpar(fontsize=14)),xmin=-10,xmax=100,ymin=-.25,ymax=-.25) +
theme(axis.text.x = element_text(size = 12, colour = "black", angle = 45, vjust = 1, hjust = 1), axis.text.y = element_text(size = 12,colour = "black"),
axis.title.y = element_text(size = 14, vjust = 2), strip.text = element_text(size = 16),
legend.text = element_text(size = 12), legend.title = element_text(size = 14), axis.line = element_line(linewidth = .6)) +
facet_wrap(~Comparison, labeller = labeller(Comparison = facetLabels)) +
stat_summary(fun="mean", geom="point", color="black", size=2) +
stat_summary(fun="mean", geom="line", color="black", size=1)
ggsave(paste("Graphs\\Clusters vs. Background\\", mod, ".pdf", sep = ""), plot = plot, width = 16, height = 6)
ggplot(df, aes(x = axisGroup, y = ModificationDifference)) +
scale_x_continuous(limits = c(-70, 150), breaks = seq(-60, 140, 20), labels = axisText) +
scale_y_continuous(limits = c(0,1), expand = c(0,0)) +
geom_boxplot(aes(group = Region)) + theme_minimal() + coord_cartesian(ylim= c(0,1), clip = "off") +
labs(x = "", y = "Difference in proportion of gene region modified") +
geom_vline(xintercept=0, color="grey", linewidth=1) + theme(plot.margin = unit(c(1,1,1,1), "lines")) +
annotation_custom(textGrob("% of gene length from TSS", gp=gpar(fontsize=14, col = "grey33")),xmin=-10,xmax=100,ymin=-.15,ymax=-.15) +
annotation_custom(textGrob("Gene region", gp=gpar(fontsize=14)),xmin=-10,xmax=100,ymin=-.25,ymax=-.25) +
theme(axis.text.x = element_text(size = 12, colour = "black", angle = 45, vjust = 1, hjust = 1), axis.text.y = element_text(size = 12,colour = "black"),
axis.title.y = element_text(size = 14, vjust = 2), strip.text = element_text(size = 16, hjust = 1.1),
legend.text = element_text(size = 12), legend.title = element_text(size = 14), axis.line = element_line(linewidth = .6)) +
facet_wrap(~Comparison, labeller = labeller(Comparison = facetLabels)) +
stat_summary(fun="mean", geom="point", color="black", size=2) +
stat_summary(fun="mean", geom="line", color="black", size=1)
ggplot(df, aes(x = axisGroup, y = ModificationDifference)) +
scale_x_continuous(limits = c(-70, 150), breaks = seq(-60, 140, 20), labels = axisText) +
scale_y_continuous(limits = c(0,1), expand = c(0,0)) +
geom_boxplot(aes(group = Region)) + theme_minimal() + coord_cartesian(ylim= c(0,1), clip = "off") +
labs(x = "", y = "Difference in proportion of gene region modified") +
geom_vline(xintercept=0, color="grey", linewidth=1) + theme(plot.margin = unit(c(1,1,1,1), "lines")) +
annotation_custom(textGrob("% of gene length from TSS", gp=gpar(fontsize=14, col = "grey33")),xmin=-10,xmax=100,ymin=-.15,ymax=-.15) +
annotation_custom(textGrob("Gene region", gp=gpar(fontsize=14)),xmin=-10,xmax=100,ymin=-.25,ymax=-.25) +
theme(axis.text.x = element_text(size = 12, colour = "black", angle = 45, vjust = 1, hjust = 1), axis.text.y = element_text(size = 12,colour = "black"),
axis.title.y = element_text(size = 14, vjust = 2), strip.text = element_text(size = 16, vjust = 1.1),
legend.text = element_text(size = 12), legend.title = element_text(size = 14), axis.line = element_line(linewidth = .6)) +
facet_wrap(~Comparison, labeller = labeller(Comparison = facetLabels)) +
stat_summary(fun="mean", geom="point", color="black", size=2) +
stat_summary(fun="mean", geom="line", color="black", size=1)
ggplot(df, aes(x = axisGroup, y = ModificationDifference)) +
scale_x_continuous(limits = c(-70, 150), breaks = seq(-60, 140, 20), labels = axisText) +
scale_y_continuous(limits = c(0,1), expand = c(0,0)) +
geom_boxplot(aes(group = Region)) + theme_minimal() + coord_cartesian(ylim= c(0,1), clip = "off") +
labs(x = "", y = "Difference in proportion of gene region modified") +
geom_vline(xintercept=0, color="grey", linewidth=1) + theme(plot.margin = unit(c(1,1,1,1), "lines")) +
annotation_custom(textGrob("% of gene length from TSS", gp=gpar(fontsize=14, col = "grey33")),xmin=-10,xmax=100,ymin=-.15,ymax=-.15) +
annotation_custom(textGrob("Gene region", gp=gpar(fontsize=14)),xmin=-10,xmax=100,ymin=-.25,ymax=-.25) +
theme(axis.text.x = element_text(size = 12, colour = "black", angle = 45, vjust = 1, hjust = 1), axis.text.y = element_text(size = 12,colour = "black"),
axis.title.y = element_text(size = 14, vjust = 2), strip.text = element_text(size = 16, vjust = 1.5),
legend.text = element_text(size = 12), legend.title = element_text(size = 14), axis.line = element_line(linewidth = .6)) +
facet_wrap(~Comparison, labeller = labeller(Comparison = facetLabels)) +
stat_summary(fun="mean", geom="point", color="black", size=2) +
stat_summary(fun="mean", geom="line", color="black", size=1)
ggplot(df, aes(x = axisGroup, y = ModificationDifference)) +
scale_x_continuous(limits = c(-70, 150), breaks = seq(-60, 140, 20), labels = axisText) +
scale_y_continuous(limits = c(0,1), expand = c(0,0)) +
geom_boxplot(aes(group = Region)) + theme_minimal() + coord_cartesian(ylim= c(0,1), clip = "off") +
labs(x = "", y = "Difference in proportion of gene region modified") +
geom_vline(xintercept=0, color="grey", linewidth=1) + theme(plot.margin = unit(c(1,1,1,1), "lines")) +
annotation_custom(textGrob("% of gene length from TSS", gp=gpar(fontsize=14, col = "grey33")),xmin=-10,xmax=100,ymin=-.15,ymax=-.15) +
annotation_custom(textGrob("Gene region", gp=gpar(fontsize=14)),xmin=-10,xmax=100,ymin=-.25,ymax=-.25) +
theme(axis.text.x = element_text(size = 12, colour = "black", angle = 45, vjust = 1, hjust = 1), axis.text.y = element_text(size = 12,colour = "black"),
axis.title.y = element_text(size = 14, vjust = 2), strip.text = element_text(size = 16, vjust = 3),
legend.text = element_text(size = 12), legend.title = element_text(size = 14), axis.line = element_line(linewidth = .6)) +
facet_wrap(~Comparison, labeller = labeller(Comparison = facetLabels)) +
stat_summary(fun="mean", geom="point", color="black", size=2) +
stat_summary(fun="mean", geom="line", color="black", size=1)
plot <- ggplot(df, aes(x = axisGroup, y = ModificationDifference)) +
scale_x_continuous(limits = c(-70, 150), breaks = seq(-60, 140, 20), labels = axisText) +
scale_y_continuous(limits = c(0,1), expand = c(0,0)) +
geom_boxplot(aes(group = Region)) + theme_minimal() + coord_cartesian(ylim= c(0,1), clip = "off") +
labs(x = "", y = "Difference in proportion of gene region modified") +
geom_vline(xintercept=0, color="grey", linewidth=1) + theme(plot.margin = unit(c(1,1,1,1), "lines")) +
annotation_custom(textGrob("% of gene length from TSS", gp=gpar(fontsize=14, col = "grey33")),xmin=-10,xmax=100,ymin=-.15,ymax=-.15) +
annotation_custom(textGrob("Gene region", gp=gpar(fontsize=14)),xmin=-10,xmax=100,ymin=-.25,ymax=-.25) +
theme(axis.text.x = element_text(size = 12, colour = "black", angle = 45, vjust = 1, hjust = 1), axis.text.y = element_text(size = 12,colour = "black"),
axis.title.y = element_text(size = 14, vjust = 2), strip.text = element_text(size = 16, vjust = 3),
legend.text = element_text(size = 12), legend.title = element_text(size = 14), axis.line = element_line(linewidth = .6)) +
facet_wrap(~Comparison, labeller = labeller(Comparison = facetLabels)) +
stat_summary(fun="mean", geom="point", color="black", size=2) +
stat_summary(fun="mean", geom="line", color="black", size=1)
ggsave(paste("Graphs\\Clusters vs. Background\\", mod, ".pdf", sep = ""), plot = plot, width = 16, height = 6)
plot <- ggplot(df, aes(x = axisGroup, y = ModificationDifference)) +
scale_x_continuous(limits = c(-70, 150), breaks = seq(-60, 140, 20), labels = axisText) +
scale_y_continuous(limits = c(0,1), expand = c(0,0)) +
geom_boxplot(aes(group = Region)) + theme_minimal() + coord_cartesian(ylim= c(0,1), clip = "off") +
labs(x = "", y = "Difference in proportion of gene region modified") +
geom_vline(xintercept=0, color="grey", linewidth=1) + theme(plot.margin = unit(c(1,1,1,1), "lines")) +
annotation_custom(textGrob("% of gene length from TSS", gp=gpar(fontsize=14, col = "grey33")),xmin=-10,xmax=100,ymin=-.15,ymax=-.15) +
annotation_custom(textGrob("Gene region", gp=gpar(fontsize=14)),xmin=-10,xmax=100,ymin=-.22,ymax=-.22) +
theme(axis.text.x = element_text(size = 12, colour = "black", angle = 45, vjust = 1, hjust = 1), axis.text.y = element_text(size = 12,colour = "black"),
axis.title.y = element_text(size = 14, vjust = 2), strip.text = element_text(size = 16),
legend.text = element_text(size = 12), legend.title = element_text(size = 14), axis.line = element_line(linewidth = .6)) +
facet_wrap(~Comparison, labeller = labeller(Comparison = facetLabels)) +
stat_summary(fun="mean", geom="point", color="black", size=2) +
stat_summary(fun="mean", geom="line", color="black", size=1)
ggsave(paste("Graphs\\Clusters vs. Background\\", mod, ".pdf", sep = ""), plot = plot, width = 16, height = 6)
plot <- ggplot(df, aes(x = axisGroup, y = ModificationDifference)) +
scale_x_continuous(limits = c(-70, 150), breaks = seq(-60, 140, 20), labels = axisText) +
scale_y_continuous(limits = c(0,1), expand = c(0,0)) +
geom_boxplot(aes(group = Region)) + theme_minimal() + coord_cartesian(ylim= c(0,1), clip = "off") +
labs(x = "", y = "Difference in proportion of gene region modified") +
geom_vline(xintercept=0, color="grey", linewidth=1) + theme(plot.margin = unit(c(1,1,.3,1), "lines")) +
annotation_custom(textGrob("% of gene length from TSS", gp=gpar(fontsize=14, col = "grey33")),xmin=-10,xmax=100,ymin=-.15,ymax=-.15) +
annotation_custom(textGrob("Gene region", gp=gpar(fontsize=14)),xmin=-10,xmax=100,ymin=-.22,ymax=-.22) +
theme(axis.text.x = element_text(size = 12, colour = "black", angle = 45, vjust = 1, hjust = 1), axis.text.y = element_text(size = 12,colour = "black"),
axis.title.y = element_text(size = 14, vjust = 2), strip.text = element_text(size = 16, vjust = 4),
legend.text = element_text(size = 12), legend.title = element_text(size = 14), axis.line = element_line(linewidth = .6)) +
facet_wrap(~Comparison, labeller = labeller(Comparison = facetLabels)) +
stat_summary(fun="mean", geom="point", color="black", size=2) +
stat_summary(fun="mean", geom="line", color="black", size=1)
ggsave(paste("Graphs\\Clusters vs. Background\\", mod, ".pdf", sep = ""), plot = plot, width = 16, height = 6)
statTestDF <- data.frame()
for (mod in unique(allResultsProportions$Modification)) {
df <- modificationDifference[modificationDifference$Modification==mod,]
for (r in unique(df$Region)) {
df1 <- df[df$Region==r,]
statTest <- t.test(df1[df1$Comparison=="Cluster modification comparisons","ModificationDifference"],
mu = mean(df1[df1$Comparison=="All R-gene modification comparisons","ModificationDifference"]))
if (is.na(statTest$p.value)==TRUE) {
statTestDF <- statTestDF
} else if (0.05 >= statTest$p.value & statTest$p.value > 0.01) {
statTestDF <- rbind(statTestDF, data.frame(Modification = mod,
Region = r,
Statistic = statTest$statistic,
p.value = statTest$p.value,
Significance = "*"))
} else if (0.01 >= statTest$p.value & statTest$p.value > 0.001) {
statTestDF <- rbind(statTestDF, data.frame(Modification = mod,
Region = r,
Statistic = statTest$statistic,
p.value = statTest$p.value,
Significance = "**"))
} else if (statTest$p.value <= 0.001) {
statTestDF <- rbind(statTestDF, data.frame(Modification = mod,
Region = r,
Statistic = statTest$statistic,
p.value = statTest$p.value,
Significance = "***"))
} else  statTestDF <- rbind(statTestDF, data.frame(Modification = mod,
Region = r,
Statistic = statTest$statistic,
p.value = statTest$p.value,
Significance = " "))
}
# Plots comparing the degree of variation among R-genes within a cluster compared to all R-genes.
facetLabels <- c(paste(mod, " - Between all R-genes", sep = ""), paste(mod, " - Between R-genes in the same cluster", sep = ""))
names(facetLabels) <- unique(df$Comparison)
plot <- ggplot(df, aes(x = axisGroup, y = ModificationDifference)) +
scale_x_continuous(limits = c(-70, 150), breaks = seq(-60, 140, 20), labels = axisText) +
scale_y_continuous(limits = c(0,1), expand = c(0,0)) +
geom_boxplot(aes(group = Region)) + theme_minimal() + coord_cartesian(ylim= c(0,1), clip = "off") +
labs(x = "", y = "Difference in proportion of gene region modified") +
geom_vline(xintercept=0, color="grey", linewidth=1) + theme(plot.margin = unit(c(1,1,.3,1), "lines")) +
annotation_custom(textGrob("% of gene length from TSS", gp=gpar(fontsize=14, col = "grey33")),xmin=-10,xmax=100,ymin=-.15,ymax=-.15) +
annotation_custom(textGrob("Gene region", gp=gpar(fontsize=14)),xmin=-10,xmax=100,ymin=-.22,ymax=-.22) +
theme(axis.text.x = element_text(size = 12, colour = "black", angle = 45, vjust = 1, hjust = 1), axis.text.y = element_text(size = 12,colour = "black"),
axis.title.y = element_text(size = 14, vjust = 2), strip.text = element_text(size = 16, vjust = 4),
legend.text = element_text(size = 12), legend.title = element_text(size = 14), axis.line = element_line(linewidth = .6)) +
facet_wrap(~Comparison, labeller = labeller(Comparison = facetLabels)) +
stat_summary(fun="mean", geom="point", color="black", size=2) +
stat_summary(fun="mean", geom="line", color="black", size=1)
ggsave(paste("Graphs\\Clusters vs. Background\\", mod, ".pdf", sep = ""), plot = plot, width = 16, height = 6)
}
write.csv(statTestDF, file = paste("Tests\\T.test_clustered.vs.background.csv", sep = ""))
unique(df$Comparison)
facetLabels
statTestDF <- data.frame()
for (mod in unique(allResultsProportions$Modification)) {
df <- modificationDifference[modificationDifference$Modification==mod,]
for (r in unique(df$Region)) {
df1 <- df[df$Region==r,]
statTest <- t.test(df1[df1$Comparison=="Cluster modification comparisons","ModificationDifference"],
mu = mean(df1[df1$Comparison=="All R-gene modification comparisons","ModificationDifference"]))
if (is.na(statTest$p.value)==TRUE) {
statTestDF <- statTestDF
} else if (0.05 >= statTest$p.value & statTest$p.value > 0.01) {
statTestDF <- rbind(statTestDF, data.frame(Modification = mod,
Region = r,
Statistic = statTest$statistic,
p.value = statTest$p.value,
Significance = "*"))
} else if (0.01 >= statTest$p.value & statTest$p.value > 0.001) {
statTestDF <- rbind(statTestDF, data.frame(Modification = mod,
Region = r,
Statistic = statTest$statistic,
p.value = statTest$p.value,
Significance = "**"))
} else if (statTest$p.value <= 0.001) {
statTestDF <- rbind(statTestDF, data.frame(Modification = mod,
Region = r,
Statistic = statTest$statistic,
p.value = statTest$p.value,
Significance = "***"))
} else  statTestDF <- rbind(statTestDF, data.frame(Modification = mod,
Region = r,
Statistic = statTest$statistic,
p.value = statTest$p.value,
Significance = " "))
}
# Plots comparing the degree of variation among R-genes within a cluster compared to all R-genes.
facetLabels <- c(paste(mod, " - Between R-genes in the same cluster", sep = ""), paste(mod, " - Between all R-genes", sep = ""))
names(facetLabels) <- unique(df$Comparison)
plot <- ggplot(df, aes(x = axisGroup, y = ModificationDifference)) +
scale_x_continuous(limits = c(-70, 150), breaks = seq(-60, 140, 20), labels = axisText) +
scale_y_continuous(limits = c(0,1), expand = c(0,0)) +
geom_boxplot(aes(group = Region)) + theme_minimal() + coord_cartesian(ylim= c(0,1), clip = "off") +
labs(x = "", y = "Difference in proportion of gene region modified") +
geom_vline(xintercept=0, color="grey", linewidth=1) + theme(plot.margin = unit(c(1,1,.3,1), "lines")) +
annotation_custom(textGrob("% of gene length from TSS", gp=gpar(fontsize=14, col = "grey33")),xmin=-10,xmax=100,ymin=-.15,ymax=-.15) +
annotation_custom(textGrob("Gene region", gp=gpar(fontsize=14)),xmin=-10,xmax=100,ymin=-.22,ymax=-.22) +
theme(axis.text.x = element_text(size = 12, colour = "black", angle = 45, vjust = 1, hjust = 1), axis.text.y = element_text(size = 12,colour = "black"),
axis.title.y = element_text(size = 14, vjust = 2), strip.text = element_text(size = 16, vjust = 4),
legend.text = element_text(size = 12), legend.title = element_text(size = 14), axis.line = element_line(linewidth = .6)) +
facet_wrap(~Comparison, labeller = labeller(Comparison = facetLabels)) +
stat_summary(fun="mean", geom="point", color="black", size=2) +
stat_summary(fun="mean", geom="line", color="black", size=1)
ggsave(paste("Graphs\\Clusters vs. Background\\", mod, ".pdf", sep = ""), plot = plot, width = 16, height = 6)
}
head(df)
ggplot(df, aes(axisGroup, y = modificationDifference, color = Comparison)) +
scale_x_continuous(limits = c(-70, 150), breaks = seq(-60, 140, 20), labels = axisText) +
scale_y_continuous(limits = c(0,1), expand = c(0,0)) +
stat_summary(fun="mean", geom="point", color="black", size=2) +
stat_summary(fun="mean", geom="line", color="black", size=1)
statTestDF <- data.frame()
compareAverages <- data.frame
for (mod in unique(allResultsProportions$Modification)) {
df <- modificationDifference[modificationDifference$Modification==mod,]
for (r in unique(df$Region)) {
df1 <- df[df$Region==r,]
statTest <- t.test(df1[df1$Comparison=="Cluster modification comparisons","ModificationDifference"],
mu = mean(df1[df1$Comparison=="All R-gene modification comparisons","ModificationDifference"]))
compareAverages <- rbind(compareAverages, data.frame(Region = r,
Modification = mod,
axisGroup = df1$axisGroup[1],
ModificationDifference = mean(df1[df1$Comparison=="Cluster modification comparisons","ModificationDifference"]),
Comparison = "Cluster modification comparisons"))
compareAverages <- rbind(compareAverages, data.frame(Region = r,
Modification = mod,
axisGroup = df1$axisGroup[1],
ModificationDifference = mean(df1[df1$Comparison=="All R-gene modification comparisons","ModificationDifference"]),
Comparison = "All R-gene modification comparisons"))
}
}
compareAverages
compareAverages <- data.frame()
for (mod in unique(allResultsProportions$Modification)) {
df <- modificationDifference[modificationDifference$Modification==mod,]
for (r in unique(df$Region)) {
df1 <- df[df$Region==r,]
statTest <- t.test(df1[df1$Comparison=="Cluster modification comparisons","ModificationDifference"],
mu = mean(df1[df1$Comparison=="All R-gene modification comparisons","ModificationDifference"]))
compareAverages <- rbind(compareAverages, data.frame(Region = r,
Modification = mod,
axisGroup = df1$axisGroup[1],
ModificationDifference = mean(df1[df1$Comparison=="Cluster modification comparisons","ModificationDifference"]),
Comparison = "Cluster modification comparisons"))
compareAverages <- rbind(compareAverages, data.frame(Region = r,
Modification = mod,
axisGroup = df1$axisGroup[1],
ModificationDifference = mean(df1[df1$Comparison=="All R-gene modification comparisons","ModificationDifference"]),
Comparison = "All R-gene modification comparisons"))
}}
ggplot(compareAverages, aes(axisGroup, y = modificationDifference, color = Comparison)) +
scale_x_continuous(limits = c(-70, 150), breaks = seq(-60, 140, 20), labels = axisText) +
scale_y_continuous(limits = c(0,1), expand = c(0,0)) +
geom_point()
compareAverages
ggplot(compareAverages, aes(axisGroup, y = ModificationDifference, color = Comparison)) +
scale_x_continuous(limits = c(-70, 150), breaks = seq(-60, 140, 20), labels = axisText) +
scale_y_continuous(limits = c(0,1), expand = c(0,0)) +
geom_point()
df <- modificationDifference[modificationDifference$Modification==mod,]
compareAverages <- data.frame()
for (r in unique(df$Region)) {
df1 <- df[df$Region==r,]
statTest <- t.test(df1[df1$Comparison=="Cluster modification comparisons","ModificationDifference"],
mu = mean(df1[df1$Comparison=="All R-gene modification comparisons","ModificationDifference"]))
compareAverages <- rbind(compareAverages, data.frame(Region = r,
axisGroup = df1$axisGroup[1],
ModificationDifference = mean(df1[df1$Comparison=="Cluster modification comparisons","ModificationDifference"]),
Comparison = "Cluster modification comparisons"))
compareAverages <- rbind(compareAverages, data.frame(Region = r,
axisGroup = df1$axisGroup[1],
ModificationDifference = mean(df1[df1$Comparison=="All R-gene modification comparisons","ModificationDifference"]),
Comparison = "All R-gene modification comparisons"))
}
compareAverages
ggplot(compareAverages, aes(axisGroup, y = ModificationDifference, color = Comparison)) +
scale_x_continuous(limits = c(-70, 150), breaks = seq(-60, 140, 20), labels = axisText) +
scale_y_continuous(limits = c(0,1), expand = c(0,0)) +
geom_point()
ggplot(compareAverages, aes(axisGroup, y = ModificationDifference, color = Comparison)) +
scale_x_continuous(limits = c(-70, 150), breaks = seq(-60, 140, 20), labels = axisText) +
scale_y_continuous(limits = c(0,1), expand = c(0,0)) +
geom_point() + geom_line()
ggplot(compareAverages, aes(axisGroup, y = ModificationDifference, color = Comparison)) +
scale_x_continuous(limits = c(-70, 150), breaks = seq(-60, 140, 20), labels = axisText) +
geom_point() + geom_line()
ggplot(compareAverages, aes(axisGroup, y = ModificationDifference, color = Comparison)) +
scale_x_continuous(limits = c(-70, 150), breaks = seq(-60, 140, 20), labels = axisText) +
scale_y_continuous(limits = c(0,1), expand = c(0,0)) +
geom_point() + geom_line() + theme_minimal() + coord_cartesian(ylim= c(0,1), clip = "off") +
geom_vline(xintercept=0, color="grey", linewidth=1) + theme(plot.margin = unit(c(1,1,.3,1), "lines")) +
theme(axis.text.x = element_text(size = 12, colour = "black", angle = 45, vjust = 1, hjust = 1), axis.text.y = element_text(size = 12,colour = "black"),
axis.title.y = element_text(size = 14, vjust = 2), strip.text = element_text(size = 16, vjust = 4),
legend.text = element_text(size = 12), legend.title = element_text(size = 14), axis.line = element_line(linewidth = .6))
ggplot(compareAverages, aes(axisGroup, y = ModificationDifference, color = Comparison)) +
scale_x_continuous(limits = c(-70, 150), breaks = seq(-60, 140, 20), labels = axisText) +
scale_y_continuous(limits = c(0,1), expand = c(0,0)) +
geom_point() + geom_line() + theme_minimal() + coord_cartesian(ylim= c(0,1), clip = "off") +
geom_vline(xintercept=0, color="grey", linewidth=1) + theme(plot.margin = unit(c(1,1,.3,1), "lines")) +
annotation_custom(textGrob("% of gene length from TSS", gp=gpar(fontsize=14, col = "grey33")),xmin=-10,xmax=100,ymin=-.15,ymax=-.15) +
annotation_custom(textGrob("Gene region", gp=gpar(fontsize=14)),xmin=-10,xmax=100,ymin=-.22,ymax=-.22) +
theme(axis.text.x = element_text(size = 12, colour = "black", angle = 45, vjust = 1, hjust = 1), axis.text.y = element_text(size = 12,colour = "black"),
axis.title.y = element_text(size = 14, vjust = 2), strip.text = element_text(size = 16, vjust = 4),
legend.text = element_text(size = 12), legend.title = element_text(size = 14), axis.line = element_line(linewidth = .6))
ggplot(compareAverages, aes(axisGroup, y = ModificationDifference, color = Comparison)) +
scale_x_continuous(limits = c(-70, 150), breaks = seq(-60, 140, 20), labels = axisText) +
scale_y_continuous(limits = c(0,1), expand = c(0,0)) +
geom_point() + geom_line() + theme_minimal() + coord_cartesian(ylim= c(0,1), clip = "off") +
geom_vline(xintercept=0, color="grey", linewidth=1) + theme(plot.margin = unit(c(1,1,.3,1), "lines")) +
annotation_custom(textGrob("% of gene length from TSS", gp=gpar(fontsize=14, col = "grey33")),xmin=-10,xmax=100,ymin=-.15,ymax=-.15) +
annotation_custom(textGrob("Gene region", gp=gpar(fontsize=14)),xmin=-10,xmax=100,ymin=-.22,ymax=-.22) +
theme(axis.text.x = element_text(size = 12, colour = "black", angle = 45, vjust = 1, hjust = 1), axis.text.y = element_text(size = 12,colour = "black"),
axis.title.y = element_text(size = 14, vjust = 2), axis.title.x = element_text(color = "white"), strip.text = element_text(size = 16, vjust = 4),
legend.text = element_text(size = 12), legend.title = element_text(size = 14), axis.line = element_line(linewidth = .6))
ggplot(compareAverages, aes(axisGroup, y = ModificationDifference, color = Comparison)) +
scale_x_continuous(limits = c(-70, 150), breaks = seq(-60, 140, 20), labels = axisText) +
scale_y_continuous(limits = c(0,1), expand = c(0,0)) +
geom_point() + geom_line() + theme_minimal() + coord_cartesian(ylim= c(0,1), clip = "off") +
geom_vline(xintercept=0, color="grey", linewidth=1) + theme(plot.margin = unit(c(1,1,.3,1), "lines")) +
annotation_custom(textGrob("% of gene length from TSS", gp=gpar(fontsize=14, col = "grey33")),xmin=-10,xmax=100,ymin=-.15,ymax=-.15) +
annotation_custom(textGrob("Gene region", gp=gpar(fontsize=14)),xmin=-10,xmax=100,ymin=-.22,ymax=-.22) +
theme(axis.text.x = element_text(size = 12, colour = "black", angle = 45, vjust = 1, hjust = 1), axis.text.y = element_text(size = 12,colour = "black"),
axis.title.y = element_text(size = 14, vjust = 2), axis.title.x = element_text(color = "white"), strip.text = element_text(size = 16, vjust = 4),
legend.text = element_text(size = 12), legend.title = element_text(size = 14), axis.line = element_line(linewidth = .6)) +
scale_color_manual(c("coral2", "darkslategrey"))
ggplot(compareAverages, aes(axisGroup, y = ModificationDifference, color = Comparison)) +
scale_x_continuous(limits = c(-70, 150), breaks = seq(-60, 140, 20), labels = axisText) +
scale_y_continuous(limits = c(0,1), expand = c(0,0)) +
geom_point() + geom_line() + theme_minimal() + coord_cartesian(ylim= c(0,1), clip = "off") +
geom_vline(xintercept=0, color="grey", linewidth=1) + theme(plot.margin = unit(c(1,1,.3,1), "lines")) +
annotation_custom(textGrob("% of gene length from TSS", gp=gpar(fontsize=14, col = "grey33")),xmin=-10,xmax=100,ymin=-.15,ymax=-.15) +
annotation_custom(textGrob("Gene region", gp=gpar(fontsize=14)),xmin=-10,xmax=100,ymin=-.22,ymax=-.22) +
theme(axis.text.x = element_text(size = 12, colour = "black", angle = 45, vjust = 1, hjust = 1), axis.text.y = element_text(size = 12,colour = "black"),
axis.title.y = element_text(size = 14, vjust = 2), axis.title.x = element_text(color = "white"), strip.text = element_text(size = 16, vjust = 4),
legend.text = element_text(size = 12), legend.title = element_text(size = 14), axis.line = element_line(linewidth = .6)) +
scale_color_manual(values = c("coral2", "darkslategrey"))
ggplot(compareAverages, aes(axisGroup, y = ModificationDifference, color = Comparison)) +
scale_x_continuous(limits = c(-70, 150), breaks = seq(-60, 140, 20), labels = axisText) +
scale_y_continuous(limits = c(0,1), expand = c(0,0)) +
geom_point(size=2) + geom_line(linewidth = 1) + theme_minimal() + coord_cartesian(ylim= c(0,1), clip = "off") +
geom_vline(xintercept=0, color="grey", linewidth=1) + theme(plot.margin = unit(c(1,1,.3,1), "lines")) +
annotation_custom(textGrob("% of gene length from TSS", gp=gpar(fontsize=14, col = "grey33")),xmin=-10,xmax=100,ymin=-.15,ymax=-.15) +
annotation_custom(textGrob("Gene region", gp=gpar(fontsize=14)),xmin=-10,xmax=100,ymin=-.22,ymax=-.22) +
theme(axis.text.x = element_text(size = 12, colour = "black", angle = 45, vjust = 1, hjust = 1), axis.text.y = element_text(size = 12,colour = "black"),
axis.title.y = element_text(size = 14, vjust = 2), axis.title.x = element_text(color = "white"), strip.text = element_text(size = 16, vjust = 4),
legend.text = element_text(size = 12), legend.title = element_text(size = 14), axis.line = element_line(linewidth = .6)) +
scale_color_manual(values = c("coral2", "darkslategrey"))
ggplot(compareAverages, aes(axisGroup, y = ModificationDifference, color = Comparison)) +
scale_x_continuous(limits = c(-70, 150), breaks = seq(-60, 140, 20), labels = axisText) +
scale_y_continuous(limits = c(0,1), expand = c(0,0)) +
geom_point(size=2) + geom_line(linewidth = 1) + theme_minimal() + coord_cartesian(ylim= c(0,1), clip = "off") +
geom_vline(xintercept=0, color="grey", linewidth=1) + theme(plot.margin = unit(c(1,1,.3,1), "lines")) +
annotation_custom(textGrob("% of gene length from TSS", gp=gpar(fontsize=14, col = "grey33")),xmin=-10,xmax=100,ymin=-.15,ymax=-.15) +
annotation_custom(textGrob("Gene region", gp=gpar(fontsize=14)),xmin=-10,xmax=100,ymin=-.22,ymax=-.22) +
theme(axis.text.x = element_text(size = 12, colour = "black", angle = 45, vjust = 1, hjust = 1), axis.text.y = element_text(size = 12,colour = "black"),
axis.title.y = element_text(size = 14, vjust = 2), strip.text = element_text(size = 16, vjust = 4),
legend.text = element_text(size = 12), legend.title = element_text(color - "white"), axis.line = element_line(linewidth = .6)) +
scale_color_manual(values = c("coral2", "darkslategrey"), labels = c("Between all R-genes", "Between R-genes in \n the same cluster")) +
labs(x = "", y = "Average difference in proportion of gene region modified")
ggplot(compareAverages, aes(axisGroup, y = ModificationDifference, color = Comparison)) +
scale_x_continuous(limits = c(-70, 150), breaks = seq(-60, 140, 20), labels = axisText) +
scale_y_continuous(limits = c(0,1), expand = c(0,0)) +
geom_point(size=2) + geom_line(linewidth = 1) + theme_minimal() + coord_cartesian(ylim= c(0,1), clip = "off") +
geom_vline(xintercept=0, color="grey", linewidth=1) + theme(plot.margin = unit(c(1,1,.3,1), "lines")) +
annotation_custom(textGrob("% of gene length from TSS", gp=gpar(fontsize=14, col = "grey33")),xmin=-10,xmax=100,ymin=-.15,ymax=-.15) +
annotation_custom(textGrob("Gene region", gp=gpar(fontsize=14)),xmin=-10,xmax=100,ymin=-.22,ymax=-.22) +
theme(axis.text.x = element_text(size = 12, colour = "black", angle = 45, vjust = 1, hjust = 1), axis.text.y = element_text(size = 12,colour = "black"),
axis.title.y = element_text(size = 14, vjust = 2), strip.text = element_text(size = 16, vjust = 4),
legend.text = element_text(size = 12), legend.title = element_text(color = "white"), axis.line = element_line(linewidth = .6)) +
scale_color_manual(values = c("coral2", "darkslategrey"), labels = c("Between all R-genes", "Between R-genes in \n the same cluster")) +
labs(x = "", y = "Average difference in proportion of gene region modified")
ggplot(compareAverages, aes(axisGroup, y = ModificationDifference, color = Comparison)) +
scale_x_continuous(limits = c(-70, 150), breaks = seq(-60, 140, 20), labels = axisText) +
scale_y_continuous(limits = c(0,1), expand = c(0,0)) +
geom_point(size=2) + geom_line(linewidth = 1) + theme_minimal() + coord_cartesian(ylim= c(0,1), clip = "off") +
geom_vline(xintercept=0, color="grey", linewidth=1) + theme(plot.margin = unit(c(1,1,.3,1), "lines")) +
annotation_custom(textGrob("% of gene length from TSS", gp=gpar(fontsize=14, col = "grey33")),xmin=-10,xmax=100,ymin=-.15,ymax=-.15) +
annotation_custom(textGrob("Gene region", gp=gpar(fontsize=14)),xmin=-10,xmax=100,ymin=-.22,ymax=-.22) +
theme(axis.text.x = element_text(size = 12, colour = "black", angle = 45, vjust = 1, hjust = 1), axis.text.y = element_text(size = 12,colour = "black"),
axis.title.y = element_text(size = 14, vjust = 2), strip.text = element_text(size = 16, vjust = 4),
legend.text = element_text(size = 12), legend.title = element_text(color = "white"), axis.line = element_line(linewidth = .6)) +
scale_color_manual(values = c("coral2", "darkslategrey"), labels = c("Between all R-genes", "Between R-genes in \n the same cluster")) +
labs(x = "", y = "Average difference in enrichment")
ggplot(compareAverages, aes(axisGroup, y = ModificationDifference, color = Comparison)) +
scale_x_continuous(limits = c(-70, 150), breaks = seq(-60, 140, 20), labels = axisText) +
scale_y_continuous(limits = c(0,1), expand = c(0,0)) +
geom_point(size=2) + geom_line(linewidth = 1) + theme_minimal() + coord_cartesian(ylim= c(0,1), clip = "off") +
geom_vline(xintercept=0, color="grey", linewidth=1) + theme(plot.margin = unit(c(1,1,.3,1), "lines")) +
annotation_custom(textGrob("% of gene length from TSS", gp=gpar(fontsize=14, col = "grey33")),xmin=-10,xmax=100,ymin=-.15,ymax=-.15) +
annotation_custom(textGrob("Gene region", gp=gpar(fontsize=14)),xmin=-10,xmax=100,ymin=-.22,ymax=-.22) +
theme(axis.text.x = element_text(size = 12, colour = "black", angle = 45, vjust = 1, hjust = 1), axis.text.y = element_text(size = 12,colour = "black"),
axis.title.y = element_text(size = 14, vjust = 2), strip.text = element_text(size = 16, vjust = 4),
legend.text = element_text(size = 12), legend.title = element_text(color = "white"), axis.line = element_line(linewidth = .6)) +
scale_color_manual(values = c("coral2", "darkslategrey"), labels = c("Between all R-genes", "Between R-genes in \n the same cluster")) +
labs(x = "", y = "Average difference in enrichment")
plot <- ggplot(compareAverages, aes(axisGroup, y = ModificationDifference, color = Comparison)) +
scale_x_continuous(limits = c(-70, 150), breaks = seq(-60, 140, 20), labels = axisText) +
scale_y_continuous(limits = c(0,1), expand = c(0,0)) +
geom_point(size=2) + geom_line(linewidth = 1) + theme_minimal() + coord_cartesian(ylim= c(0,1), clip = "off") +
geom_vline(xintercept=0, color="grey", linewidth=1) + theme(plot.margin = unit(c(1,1,.3,1), "lines")) +
annotation_custom(textGrob("% of gene length from TSS", gp=gpar(fontsize=14, col = "grey33")),xmin=-10,xmax=100,ymin=-.15,ymax=-.15) +
annotation_custom(textGrob("Gene region", gp=gpar(fontsize=14)),xmin=-10,xmax=100,ymin=-.22,ymax=-.22) +
theme(axis.text.x = element_text(size = 12, colour = "black", angle = 45, vjust = 1, hjust = 1), axis.text.y = element_text(size = 12,colour = "black"),
axis.title.y = element_text(size = 14, vjust = 2), strip.text = element_text(size = 16, vjust = 4),
legend.text = element_text(size = 12), legend.title = element_text(color = "white"), axis.line = element_line(linewidth = .6)) +
scale_color_manual(values = c("coral2", "darkslategrey"), labels = c("Between all R-genes", "Between R-genes in \n the same cluster")) +
labs(x = "", y = "Average difference in enrichment")
ggsave(paste("Graphs\\Clusters vs. Background\\", mod, "_lineplot.pdf", sep = ""), plot = plot, width = 8, height = 6)
plot <- ggplot(compareAverages, aes(axisGroup, y = ModificationDifference, color = Comparison)) +
scale_x_continuous(limits = c(-70, 150), breaks = seq(-60, 140, 20), labels = axisText) +
scale_y_continuous(limits = c(0,1), expand = c(0,0)) +
geom_point(size=2) + geom_line(linewidth = 1) + theme_minimal() + coord_cartesian(ylim= c(0,1), clip = "off") +
geom_vline(xintercept=0, color="grey", linewidth=1) + theme(plot.margin = unit(c(1,1,.3,1), "lines")) +
annotation_custom(textGrob("% of gene length from TSS", gp=gpar(fontsize=14, col = "grey33")),xmin=-10,xmax=100,ymin=-.15,ymax=-.15) +
annotation_custom(textGrob("Gene region", gp=gpar(fontsize=14)),xmin=-10,xmax=100,ymin=-.22,ymax=-.22) +
theme(axis.text.x = element_text(size = 12, colour = "black", angle = 45, vjust = 1, hjust = 1), axis.text.y = element_text(size = 12,colour = "black"),
axis.title.y = element_text(size = 14, vjust = 2), strip.text = element_text(size = 16, vjust = 4),
legend.text = element_text(size = 12), legend.title = element_text(color = "white"), axis.line = element_line(linewidth = .6)) +
scale_color_manual(values = c("coral2", "darkslategrey"), labels = c("Between all R-genes \n", "Between R-genes in \nthe same cluster")) +
labs(x = "", y = "Average difference in enrichment")
ggsave(paste("Graphs\\Clusters vs. Background\\", mod, "_lineplot.pdf", sep = ""), plot = plot, width = 8, height = 6)
